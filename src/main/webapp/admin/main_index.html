<#--包含-->
<#include "common/header.html">

  
        <script type="text/javascript">
      window.onload=function(){
    	  var $table = $('#table-large-columns');
    		
    		$table.bootstrapTable('destroy');//这里必须要添加这个销毁，否则新增、修改、查看的切换可编辑列表中的数据可能加载出现问题。
    		 
    	    $table.bootstrapTable({
    	    url: "${ctx}/admin/list", 
    	    dataType: "json",
    	    pagination: true, //分页
    	    singleSelect: false,
    	   // data-locale:"zh-US", //表格汉化
    	    //search: true, //显示搜索框
    	    sidePagination: "server", //服务端处理分页
    	          columns: [
    	                  {
    	                    title: 'ID',
    	                      field: 'id',
    	                      align: 'center',
    	                      valign: 'middle'
    	                  }, 
    	                  {
    	                      title: '用户名',
    	                      field: 'username',
    	                      align: 'center',
    	                      valign: 'middle',
    	                  }, 
    	                  {
    	                      title: '状态',
    	                      field: 'status',
    	                      align: 'center'
    	                  }, 
    	                  {
    	                      title: '操作',
    	                      field: 'id',
    	                      align: 'center',
    	                      formatter:function(value,row,index){ 
    	                    	  
    	                    	  //admin没有编辑和删除的功能，
    	                    	  if(value == 1){
    	                    	  		return "";
    	                    	  }
    	                    	  
    	                    	  
    	       	                   var e = '<a href="#" onclick="openModify(\''+ row.id + '\')">编辑</a> ';  
    	    	                   var d = '<a href="#" onclick="del(\''+ row.id +'\')">删除</a> ';  
    	    	                   return e+d; 
    	                    		  
    	                    	  
    	                    } 
    	                  } 
    	              ]
    	      });
      }
      
      
      //打开新增窗口
      function openAdd(){
    	  layer.open({
    		  type: 1,
    		  title: false,
    		  closeBtn: 0,
    		  area: '688px',
    		  skin: 'layui-layer-nobg', //没有背景色
    		  shadeClose: true,
    		  content: $('#tab_0')
    		});
      }
      
      
      //关闭窗口
      function doClose(){
    	  layer.closeAll();
      }
      
      //保存方法
      function doSave(){
    	  
    	  //$('#myform').serialize()
    	  //加了判断
    	  /* var check = doCheck();
    	  if(!check){
    		  return false;
    	  } */
    	  
    	  var param = "${ctx}/admin/save";

      	  var statusB = $("#status").prop("checked");
      	  if(statusB){
      		  param += "?status=1";
      	  }else{
      		  param += "?status=0";
      		  
      	  }
      	  
    	  //提交
    	  $.ajax({
        		  url : param,
        		  type : "post",
        		  data : $('#subForm').serialize(),
        		  dataType : "json",
        		  success : function(data){
        			  if(!data){
        				  layer.alert("操作失败");
        				  return false;
        			  }
        			  if(!data.ok){
        				  layer.alert("操作失败," + data.content);
        				  return false;
        			  }
        			  layer.alert(data.content);
        			  
        			  //刷新 datatable
        			  $('#table-large-columns').bootstrapTable(  
       		              "refresh",  
       		              {  
       		                  url:"${ctx}/admin/list"  
       		              }  
        		      ); 
        			  
        			  //关闭layer窗口
        			  layer.closeAll();
        		  },
        		  error:function(data){
        			  console.log(data);
        		  }
    	  });
    	  
    	  
    	  
    	
    	  
      }
      
      
   /*  //验证方法
    function doCheck(){

  	  var username = $("#tab_0").find("[name=username]").val();
  	  var password = $("#tab_0").find("[name=password]").val();
  	  var password2 = $("#tab_0").find("#password2").val();
  	  var statusB = $("#tab_0").find("[name=status]").prop("checked");
      
  	  if(!username){
  		  layer.alert('用户名不能为空');
  		  return false;
  	  }
  	 
  	  //密码不能为空
  	  if(!password){
  		layer.alert("密码不能为空");
  		return false;
  	  }
  	  
  	  //重复密码不能为空
  	if(!password2){
  		layer.alert("重复密码不能为空");
  		return false;
  	  }
  	  
  	  //两个密码要一样
  	if(password2!=password){
  		layer.alert("两个密码要一样");
  		return false;
  	  }
  	  
      return true;
    } */
    
    //修改方法
    function openModify(id){
    	openAdd(id);
    }
    
    
    //修改方法
    function doModify(){
    	
    }
</script>


            <!-- BEGIN CONTENT -->
            <div class="page-content-wrapper">
                <!-- BEGIN CONTENT BODY -->
                <div class="page-content">
                    <!-- BEGIN PAGE HEADER-->
                    
                    <!-- BEGIN PAGE BAR -->
                    <div class="page-bar">
                        <ul class="page-breadcrumb">
                            <li>
                                <a href="index.html">Home</a>
                                <i class="fa fa-circle"></i>
                            </li>
                            <li>
                                <a href="#">管理员管理</a>
                                <i class="fa fa-circle"></i>
                            </li>
                        </ul>
                       
                    </div>
                    <!-- END PAGE BAR -->
                   
                    <!-- END PAGE TITLE-->
                    <!-- END PAGE HEADER-->

                    <div class="row">
                        <div class="col-md-12">
                            <!-- BEGIN EXAMPLE TABLE PORTLET-->
                            <div class="portlet light bordered">
                                <div class="portlet-title">
                                    
                                <div class="portlet-body">
                                    <div class="table-toolbar">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="btn-group">
                                                    <button id="sample_editable_1_new" class="btn sbold green" onclick="openAdd()"> 新增
                                                        <i class="fa fa-plus"></i>
                                                    </button>
                                                </div>
                                            </div>
                                           
                                        </div>
                                    </div>
                                    
                                    <!-- 教程请看http://www.bijishequ.com/detail/441766?p= -->
                                    <!-- <table data-toggle="table" data-url="${ctx}/admin/list">
									    <thead>
									        <tr>
									            <th data-field="id">ID</th>
									            <th data-field="username">用户名</th>
									            <th data-field="create_time">创建时间</th>
									        </tr>
									    </thead>
									</table> -->
									
									<!-- 
									data-pagination:数据分页 
									data-toggle:数据切换
									
									-->
									<!-- <table id="table-large-columns" 
										data-toggle="table" 
										data-sort-name="id" 
										data-url="${ctx}/admin/list" 
										data-height="398" 
										data-pagination="true" 
										data-show-refresh="true" 
										data-row-style="rowStyle">
									 <thead>
									        <tr>
									            <th data-field="id">ID</th>
									            <th data-field="username">用户名</th>
									            <th data-field="create_time">创建时间</th>
									        </tr>
									    </thead>
									</table> -->
									
									
									
									 <table id="table-large-columns" ></table> 
									
                                 </div>
                            </div>
                            <!-- END EXAMPLE TABLE PORTLET-->
                        </div>
                    </div>
                </div>
                <!-- END CONTENT BODY -->
            </div>
            <!-- END CONTENT -->
            <!-- BEGIN QUICK SIDEBAR -->
         </div>
        <!-- END CONTAINER -->
        
        
        
 <#--新增弹出框-->
  <div class="tab-pane active" id="tab_0" style="display:none;">
      <div class="portlet box green">
          <div class="portlet-title">
              <div class="caption">
                  <i class="fa fa-gift"></i>新增</div>
              <!-- <div class="tools">
                  
                  <a href="javascript:;" class="remove"> </a>
              </div> -->
          </div>
          <div class="portlet-body form">
              <!-- BEGIN FORM-->
              <form id="subForm" class="form-horizontal">
                  <div class="form-body">
                     <div class="form-group">
                          <label class="control-label col-md-3">用户名
                              <span class="required"> * </span>
                          </label>
                          <div class="col-md-4">
                              <input type="text" class="form-control" name="username" />
                              <!-- <span class="help-block">请输入用户名</span> -->
                          </div>
                      </div>
                     <div class="form-group">
                          <label class="control-label col-md-3">密码
                              <span class="required"> * </span>
                          </label>
                          <div class="col-md-4">
                              <input type="password" class="form-control" name="password" />
                              <!-- <span class="help-block">请输入密码</span> -->
                          </div>
                      </div>
                     <div class="form-group">
                          <label class="control-label col-md-3">重复密码
                              <span class="required"> * </span>
                          </label>
                          <div class="col-md-4">
                              <input type="password" class="form-control" id="password2" />
                              <!-- <span class="help-block">请重复输入密码</span> -->
                          </div>
                      </div>
                     <div class="form-group">
                          <label class="control-label col-md-3">状态
                          </label>
                          <div class="col-md-4">
                              <input type="checkbox" checked class="make-switch" id="status" data-size="small">
                          </div>
                      </div>
                      
                  </div>
                  <div class="form-actions">
                      <div class="row">
                          <div class="col-md-offset-3 col-md-9">
                              <button type="button" class="btn btn-circle green" onclick="doSave()">确定</button>
                              <button type="button" class="btn btn-circle grey-salsa btn-outline" onclick="doClose()">关闭</button>
                          </div>
                      </div>
                  </div>
              </form>
              <!-- END FORM-->
          </div>
      </div>
 </div>
 
 
 
 <#--修改弹出框-->
  <div class="tab-pane active" id="tab_2" style="display:none;">
      <div class="portlet box green">
          <div class="portlet-title">
              <div class="caption">
                  <i class="fa fa-gift"></i>新增</div>
              <!-- <div class="tools">
                  
                  <a href="javascript:;" class="remove"> </a>
              </div> -->
          </div>
          <div class="portlet-body form">
              <!-- BEGIN FORM-->
              <form id="subForm" class="form-horizontal">
              	<input type="hidden" name="id" id="id"/>
                  <div class="form-body">
                     <div class="form-group">
                          <label class="control-label col-md-3">用户名
                              <span class="required"> * </span>
                          </label>
                          <div class="col-md-4">
                              <input type="text" class="form-control" name="username" />
                              <!-- <span class="help-block">请输入用户名</span> -->
                          </div>
                      </div>
                    
                     <div class="form-group">
                          <label class="control-label col-md-3">状态
                          </label>
                          <div class="col-md-4">
                              <input type="checkbox" checked class="make-switch" id="status" data-size="small">
                          </div>
                      </div>
                      
                  </div>
                  <div class="form-actions">
                      <div class="row">
                          <div class="col-md-offset-3 col-md-9">
                              <button type="button" class="btn btn-circle green" onclick="doModify()">确定</button>
                              <button type="button" class="btn btn-circle grey-salsa btn-outline" onclick="doClose()">关闭</button>
                          </div>
                      </div>
                  </div>
              </form>
              <!-- END FORM-->
          </div>
      </div>
 </div>
 <#include "common/footer.html">      
   